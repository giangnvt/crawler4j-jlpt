Verb-casual, past + あげく（に）
Noun + のあげく（に）